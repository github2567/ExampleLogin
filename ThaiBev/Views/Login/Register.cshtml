<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Registration - IT 02-2</title>
    
    <link rel="stylesheet" href="~/assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/assets/css/plugins.min.css" />
    <link rel="stylesheet" href="~/assets/css/kaiadmin.min.css" />

    <link rel="stylesheet" href="~/assets/css/base.css" />
    <link rel="stylesheet" href="~/assets/css/login.css" />
    <link rel="stylesheet" href="~/assets/css/common.css" />
</head>
<body id="login-page">

    <script src="~/assets/js/bootstrap.bundle.min.js"></script>
    <script src="~/Scripts/angular.min.js")" type="text/javascript"></script>
    <script src="~/Scripts/angular-route.min.js")" type="text/javascript"></script>
    <script src="~/scripts/angular-ui/ui-bootstrap-tpls.min.js"></script>
    <script src="~/scripts/angular-ui/ui-bootstrap-tpls.js"></script>
    <script src="~/Scripts/Controllers/LoginController.js")" type="text/javascript"></script>
    
    <div class="container mt-5" ng-app="NGLogin" ng-controller="RegisterController" style="max-width:100%;">
        <!-- Header -->
        <div class="bg-success text-white text-center p-2 mb-4">
            <h4>IT 02-2</h4>
        </div>

        <div class="d-flex justify-content-center align-items-center">

            <form asp-action="ConfirmRegister" asp-controller="Login" method="post" enctype="multipart/form-data" style="max-width:400px;">
            @* <div style="max-width:400px;"> *@
                <div class="form-group mb-3 d-flex">
                    <div class="col-5">
                        <label for="User">User</label> :
                    </div>
                    <div class="col-7">
                        <input type="text" class="form-control" id="User" name="User" required />
                    </div>
                </div>

                <div class="form-group mb-3 d-flex">
                    <div class="col-5">
                        <label for="Password">Password</label> :
                    </div>
                    <div class="col-7">
                        <input type="password" class="form-control" id="Password" name="Password" required />
                    </div>
                </div>

                <div class="form-group mb-3 d-flex">
                    <div class="col-5">
                        <label for="ConfirmPassword">Confirm Password</label> :
                    </div>
                    <div class="col-7">
                        <input type="password" class="form-control" id="ConfirmPassword" name="ConfirmPassword" required />
                    </div>
                </div>

                <div class="form-group mb-3 d-flex">
                    <div class="col-5">
                        
                    </div>
                    <div class="col-7">
                        <label id="errorMessage" style="color:red !important;"></label>
                    </div>
                </div>

                <div>
                    <span class="txt-list-error">@Html.ValidationSummary(true, "", new { @class = "text-danger" })</span>
                </div>

                <div class="form-group mb-3 d-flex">
                    <div class="col-4">
                    </div>
                    <div class="col-8">
                        <button type="submit" class="btn mb-3" id="confirmRegis" style="background-color:lightgray">
                            สมัครสมาชิก
                        </button>

                        @* <input type="button" class="btn btn-danger mb-3" value="ยกเลิก" onclick="window.location.href='@Url.Action("Index", "Login")'" title="ยกเลิก"> *@
                        <input type="button" ng-click="RegisterCancel()" class="btn btn-danger mb-3" value="ยกเลิก" title="ยกเลิก">
                    </div>
                </div>

            </form>

        </div>
    </div>


    <script src="~/assets/js/core/jquery-3.7.1.min.js"></script>
    <script src="~/assets/js/core/popper.min.js"></script>
    <script src="~/assets/js/core/bootstrap.min.js"></script>

    <!-- Sweet Alert -->
    <script src="~/assets/js/plugin/sweetalert/sweetalert2@11.js"></script>
        
    <script>

        $(document).ready(function () {

            $("#confirmRegis").click(function (e) {

                e.preventDefault();
                var $form = $(this).closest('form');

                Swal.fire({
                    icon: "info",
                    title: "คุณกรอกข้อมูลสมัครสมาชิกครบถ้วนแล้ว",
                    showCancelButton: true,
                    confirmButtonText: "ยืนยันสมัคร",
                    cancelButtonText: "ยกเลิก",
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    customClass: {
                        confirmButton: "btn btn-primary",
                        cancelButton: "btn btn-danger"
                    },
                    buttonsStyling: false
                }).then((result) => {
                    if (result.isConfirmed) {
                        
                        var user = $("#User").val();
                        var password = $("#Password").val();
                        var confirm = $("#ConfirmPassword").val();
                        
                        $.ajax({
                            url: '@Url.Action("ConfirmRegister", "Login")',
                            type: 'POST',
                            contentType: 'application/json',
                            data: JSON.stringify({
                                UserName: user,
                                Password: password,
                                ConfirmPassword: confirm
                            }),

                            success: function (response) {
                                // Swal.fire({
                                //     title: "@Html.Raw(ViewBag.completeText)",
                                //     html: `
                                //                     <img src="../assets/img/common/email-icon01.png" alt="Success"/>
                                //                     <div>@Html.Raw(ViewBag.completeDetailText)</div>
                                //                 `,
                                //     confirmButtonText: "OK",
                                //     customClass: {
                                //         confirmButton: "btn btn-primary"
                                //     },
                                //     buttonsStyling: false
                                // }).then(() => {
                                //     window.location.href = '@Url.Action("Index", "Login")';
                                // });
                                window.location.href = '@Url.Action("Index", "Login")';
                            },
                            error: function (xhr, status, error) {
                                $("#errorMessage").text(xhr.responseText);
                            }
                        });
                        
                    }
                });
            });

        });

    </script>



</body>
</html>
